name: CI - Kiá»ƒm tra Cháº¥t lÆ°á»£ng Code

# Workflow nÃ y sáº½ cháº¡y khi cÃ³ push lÃªn nhÃ¡nh 'main' hoáº·c 'master'
on:
  push:
    branches: ["main", "master"]

jobs:
  # JOB CHÃNH: CHáº Y BÃ€I KIá»‚M THá»¬ (CI)
  # Äáº£m báº£o táº¥t cáº£ cÃ¡c service hoáº¡t Ä‘á»™ng Ä‘Ãºng trÆ°á»›c khi tiáº¿n hÃ nh cÃ¡c bÆ°á»›c khÃ¡c
  run-tests:
    name: ğŸ§ª Install & Test All Services
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js 18
        uses: actions/setup-node@v4
        with:
          node-version: 18

      # CÃ€I Äáº¶T DEPENDENCIES CHO AUTH
      - name: Install dependencies for auth service
        run: npm install
        working-directory: ./auth # <--- Báº¯t buá»™c cháº¡y lá»‡nh trong thÆ° má»¥c 'auth'

      # CÃ€I Äáº¶T DEPENDENCIES CHO PRODUCT
      - name: Install dependencies for product service
        run: npm install
        working-directory:
          ./product # <--- Báº¯t buá»™c cháº¡y lá»‡nh trong thÆ° má»¥c 'product'
          # Báº¡n cÃ³ thá»ƒ thÃªm cÃ¡c service khÃ¡c vÃ o Ä‘Ã¢y náº¿u cáº§n

      # CHáº Y TEST CHO AUTH
      - name: Testing auth service
        run: npm test
        working-directory: ./auth # <--- Báº¯t buá»™c cháº¡y lá»‡nh test trong thÆ° má»¥c 'auth'

      # CHáº Y TEST CHO PRODUCT
      - name: Testing product service
        run: npm test
        working-directory:
          ./product # <--- Báº¯t buá»™c cháº¡y lá»‡nh test trong thÆ° má»¥c 'product'
          # Cháº¡y test cho cÃ¡c service khÃ¡c...

      - name: âœ… All tests passed successfully
        run: echo "ğŸ‰ All tests passed!"
